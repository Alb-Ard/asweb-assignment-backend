import{_ as L,a as z}from"./InputField.54f2adc8.js";import{_ as B}from"./Fab.8c80f483.js";import{g as N,v as U,r as u,x as M,l as P,h as k,c as h,q as e,y as E,b as o,z as x,a as S,w,o as _,m as F,A as R,p as q,f as O,_ as $}from"./entry.9dbfbc2c.js";import{u as j}from"./usePlacesStore.5fcb8dfe.js";import{v as G,u as H,i as J}from"./vue-leaflet.es.86c67db3.js";import{w as K,i as Q}from"./dataStore.d7792384.js";import"./index.a5ba7d56.js";const b=v=>(q("data-v-2a85a488"),v=v(),O(),v),T={key:0},W={key:1},X={class:"select-location-map"},Y=b(()=>S("p",{class:"hidden"},"Update data",-1)),Z=b(()=>S("span",{class:"fa fa-check"},null,-1)),ee=N({__name:"[id]",setup(v){const A=U(),I=u(A.params.id),f=M(),g=j(),l=P(()=>{var t;return(t=g.places)==null?void 0:t.find(a=>a._id===I.value)}),p=u(""),d=u(""),c=u(""),n=u(),s=u(),V=u(!1),C=t=>{n.value=t.latlng.lat,s.value=t.latlng.lng},D=()=>{g.updateAsync({_id:I.value,name:p.value!=""?p.value:void 0,description:d.value!=""?d.value:void 0,location:n.value!==void 0&&s.value!==void 0?[n.value,s.value]:void 0,photoSrcs:c.value!=""?[c.value]:void 0})};return k(f.userStore,t=>{t.userData&&K(V,Q(()=>g.places,g),null)},{immediate:!0}),k(l,()=>{var t,a,i,r,y;p.value=((t=l.value)==null?void 0:t.name)??"",d.value=((a=l.value)==null?void 0:a.description)??"",c.value=((i=l.value)==null?void 0:i.photoSrcs.at(0))??"",n.value=(r=l.value)==null?void 0:r.location[0],s.value=(y=l.value)==null?void 0:y.location[1]}),(t,a)=>{const i=z,r=L,y=B;return _(),h("main",null,[e(V)||!e(l)||e(f).userStore.userData===void 0?(_(),h("p",T,"Loading...")):e(f).userStore.userData===null||e(f).userStore.userData._id!==e(l).owner._id?(_(),h("p",W,"Log in to edit this place")):(_(),h("form",{key:2,action:"#",method:"post",onSubmit:a[3]||(a[3]=E(m=>D(),["prevent"]))},[o(i,{text:"Name",for:"name"}),o(r,{class:"new-name-field",type:"text",modelValue:e(p),"onUpdate:modelValue":a[0]||(a[0]=m=>x(p)?p.value=m:null),id:"name",placeholder:"Input a name..."},null,8,["modelValue"]),o(i,{text:"Description",for:"description"}),o(r,{class:"new-text-field",type:"text",modelValue:e(d),"onUpdate:modelValue":a[1]||(a[1]=m=>x(d)?d.value=m:null),id:"description",placeholder:"Input description..."},null,8,["modelValue"]),o(i,{text:"Image",for:"image"}),o(r,{class:"new-image-field",type:"text",modelValue:e(c),"onUpdate:modelValue":a[2]||(a[2]=m=>x(c)?c.value=m:null),id:"image",placeholder:"Input image link..."},null,8,["modelValue"]),o(i,{text:"Position",for:"map"}),S("div",X,[o(e(J),{"use-global-leaflet":!1,zoom:14,center:[e(n)??44.13873257393356,e(s)??12.239157218933107],onClick:C},{default:w(()=>[o(e(G),{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png","layer-type":"base",name:"OpenStreetMap"}),e(n)&&e(s)?(_(),F(e(H),{key:0,"lat-lng":[e(n),e(s)]},null,8,["lat-lng"])):R("",!0)]),_:1},8,["center"])]),o(y,{color:"primary",type:"submit"},{default:w(()=>[Y,Z]),_:1})],32))])}}});const ue=$(ee,[["__scopeId","data-v-2a85a488"]]);export{ue as default};
