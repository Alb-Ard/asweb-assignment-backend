import{S as D,r as d,x as A,J as C,l as _,T as i,U as u}from"./entry.bb74548b.js";import{a as g}from"./dataStore.d7792384.js";const E=D("itineraries",()=>{const r=d(void 0),l=d(0),n=A(),p=async()=>{try{if(!n.userStore.userData)return;const e=await i.get(u("itinerary")+"?page="+l.value,{withCredentials:!0});if(e.status!==200)return;g(e.data)&&l.value++,r.value?e.data.forEach(f):r.value=[...e.data]}catch{}},c=async e=>{try{if(!n.userStore.userData)return;const t=await i.get(u("itinerary")+"/"+e,{withCredentials:!0});if(t.status!==200)return;r.value?f(t.data):r.value=[t.data]}catch{}},y=async e=>{let t;try{if(!n.userStore.userData||(t=await i.post(u("itinerary"),{name:e,owner:n.userStore.userData._id},{withCredentials:!0}),t.status!==200))return!1}catch{return!1}return await c(t.data),!0},h=async e=>{var a;const{_id:t,...s}=e;try{if(!n.userStore.userData||(await i.patch(u("itinerary")+"/"+t,s,{withCredentials:!0})).status!==200)return!1}catch{return!1}return(a=r.value)!=null&&a.some(o=>o._id===t)&&await c(t),!0},w=async e=>{var t;try{if(!n.userStore.userData||(await i.delete(u("itinerary")+"/"+e,{withCredentials:!0})).status!==200)return!1;r.value=(t=r.value)==null?void 0:t.filter(a=>a._id!==e)}catch{return!1}return!0},v=async(e,t)=>{var s;try{if(!n.userStore.userData||(await i.post(u("itinerary")+"/"+e+"/places",{id:t},{withCredentials:!0})).status!==200)return!1}catch{return!1}return(s=r.value)!=null&&s.some(a=>a._id===e)&&await c(e),!0},S=async(e,t,s)=>{var a;try{if(!n.userStore.userData||(await i.patch(u("itinerary")+"/"+e+"/places",{swapPlaces:[t,s]},{withCredentials:!0})).status!==200)return!1}catch{return!1}return(a=r.value)!=null&&a.some(o=>o._id===e)&&await c(e),!0},m=async(e,t)=>{var s;try{if(!n.userStore.userData||(await i.delete(u("itinerary")+"/"+e+"/places/"+t,{withCredentials:!0})).status!==200)return!1}catch{return!1}return(s=r.value)!=null&&s.some(a=>a._id===e)&&await c(e),!0},f=e=>{r.value||(r.value=[]);const t=r.value.find(s=>s._id===e._id);t?Object.assign(t,e):r.value.push(e)};return C(()=>{n.userStore.userData||(r.value=void 0)}),{itineraries:_(()=>r.value),fetchNextAsync:p,fetchOneAsync:c,createAsync:y,updateAsync:h,deleteAsync:w,addPlaceAsync:v,swapPlacesAsync:S,removePlaceAsync:m}});export{E as u};
