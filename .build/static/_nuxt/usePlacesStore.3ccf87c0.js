import{S as A,r as p,x as _,l as m,T as r,U as n}from"./entry.bb74548b.js";import{a as x}from"./dataStore.d7792384.js";const P=A("places",()=>{const s=p(void 0),l=p(0),u=_(),d=async()=>{try{const e=await r.get(n("place")+"?page="+l.value);if(e.status!==200)return;x(e.data)&&l.value++,e.data.forEach(o)}catch{}},i=async e=>{try{const t=await r.get(n("place")+"/"+e);if(t.status!==200)return;o(t.data)}catch{}},h=async(e,t)=>{try{if(!u.userStore.userData)return!1;const a=await r.post(n("place"),{name:e,owner:u.userStore.userData._id,location:t},{withCredentials:!0});return a.status!==200?!1:(await i(a.data),a.data)}catch{return null}},y=async e=>{var t;try{const{_id:a,...c}=e;if((await r.patch(n("place")+"/"+a,c,{withCredentials:!0})).status!==200)return!1;const f=(t=s.value)==null?void 0:t.find(g=>g._id===a);return f?o({...f,...e}):await i(e._id),!0}catch{return!1}},v=async e=>{var t;try{return(await r.delete(n("place")+"/"+e,{withCredentials:!0})).status!==200?!1:((t=s.value)!=null&&t.some(c=>c._id===e)&&(s.value=s.value.filter(c=>c._id!==e)),!0)}catch{return!1}},w=async(e,t)=>{try{if(!u.userStore.userData||(t>0?await r.post(n("place")+"/"+e+"/review",{star:t},{withCredentials:!0}):await r.delete(n("place")+"/"+e+"/review",{withCredentials:!0})).status!==200)return!1}catch{return!1}return await i(e),!0},o=e=>{s.value||(s.value=[]);const t=s.value.find(a=>a._id===e._id);t?Object.assign(t,e):s.value.push(e),s.value=s.value};return{places:m(()=>s.value),fetchNextAsync:d,fetchOneAsync:i,createAsync:h,updateAsync:y,updateReviewAsync:w,deleteAsync:v}});export{P as u};
