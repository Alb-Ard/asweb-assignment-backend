import{_ as L,a as z}from"./InputField.5fb3cb1e.js";import{_ as N}from"./Fab.eb68e09a.js";import{g as U,v as M,r as u,x as P,l as E,h as V,c as b,q as e,y as F,b as o,z as x,a as S,w as k,o as v,m as R,A as q,B as O,p as T,f as $,_ as j}from"./entry.bb74548b.js";import{u as G}from"./usePlacesStore.3ccf87c0.js";import{v as H,u as J,i as K}from"./vue-leaflet.es.9a8bcf82.js";import{w,i as Q}from"./dataStore.d7792384.js";import"./index.f4bf0056.js";const A=f=>(T("data-v-7b6701f4"),f=f(),$(),f),W={key:0},X={key:1},Y={class:"select-location-map"},Z=A(()=>S("p",{class:"hidden"},"Update data",-1)),ee=A(()=>S("span",{class:"fa fa-check"},null,-1)),ae=U({__name:"[id]",setup(f){const B=M(),I=u(B.params.id),g=P(),h=G(),l=E(()=>{var t;return(t=h.places)==null?void 0:t.find(a=>a._id===I.value)}),p=u(""),c=u(""),r=u(""),s=u(),i=u(),n=u(!1),C=t=>{n.value||(s.value=t.latlng.lat,i.value=t.latlng.lng)},D=()=>{w(n,h.updateAsync({_id:I.value,name:p.value!=""?p.value:void 0,description:c.value!=""?c.value:void 0,location:s.value!==void 0&&i.value!==void 0?[s.value,i.value]:void 0,photoSrcs:r.value!=""?[r.value]:void 0}),!1).then(t=>{O("/management/")})};return V(g.userStore,t=>{t.userData&&w(n,Q(()=>h.places,h),null)},{immediate:!0}),V(l,()=>{var t,a,d,m,y;p.value=((t=l.value)==null?void 0:t.name)??"",c.value=((a=l.value)==null?void 0:a.description)??"",r.value=((d=l.value)==null?void 0:d.photoSrcs.at(0))??"",s.value=(m=l.value)==null?void 0:m.location[0],i.value=(y=l.value)==null?void 0:y.location[1]},{immediate:!0}),(t,a)=>{const d=z,m=L,y=N;return v(),b("main",null,[e(n)||!e(l)||e(g).userStore.userData===void 0?(v(),b("p",W,"Loading...")):e(g).userStore.userData===null||e(g).userStore.userData._id!==e(l).owner._id?(v(),b("p",X,"Log in to edit this place")):(v(),b("form",{key:2,action:"#",method:"post",onSubmit:a[3]||(a[3]=F(_=>D(),["prevent"]))},[o(d,{text:"Name",for:"name"}),o(m,{disabled:e(n),class:"new-name-field",type:"text",modelValue:e(p),"onUpdate:modelValue":a[0]||(a[0]=_=>x(p)?p.value=_:null),id:"name",placeholder:"Input a name..."},null,8,["disabled","modelValue"]),o(d,{text:"Description",for:"description"}),o(m,{disabled:e(n),class:"new-text-field",type:"text",modelValue:e(c),"onUpdate:modelValue":a[1]||(a[1]=_=>x(c)?c.value=_:null),id:"description",placeholder:"Input description..."},null,8,["disabled","modelValue"]),o(d,{text:"Image",for:"image"}),o(m,{disabled:e(n),class:"new-image-field",type:"text",modelValue:e(r),"onUpdate:modelValue":a[2]||(a[2]=_=>x(r)?r.value=_:null),id:"image",placeholder:"Input image link..."},null,8,["disabled","modelValue"]),o(d,{text:"Position",for:"map"}),S("div",Y,[o(e(K),{"use-global-leaflet":!1,zoom:14,center:[e(s)??44.13873257393356,e(i)??12.239157218933107],id:"map",onClick:C},{default:k(()=>[o(e(H),{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png","layer-type":"base",name:"OpenStreetMap"}),e(s)&&e(i)?(v(),R(e(J),{key:0,"lat-lng":[e(s),e(i)]},null,8,["lat-lng"])):q("",!0)]),_:1},8,["center"])]),o(y,{disabled:e(n),color:"primary",type:"submit"},{default:k(()=>[Z,ee]),_:1},8,["disabled"])],32))])}}});const ue=j(ae,[["__scopeId","data-v-7b6701f4"]]);export{ue as default};
