import{g as $,x as z,r as l,h as U,c as _,a as n,q as t,b as a,w as u,d,F as V,t as B,m as I,A as N,y as M,z as D,B as R,e as Y,D as j,n as G,o as c,p as H,f as J,_ as K}from"./entry.9dbfbc2c.js";import{_ as O,a as Q}from"./InputField.54f2adc8.js";import{w as P}from"./dataStore.d7792384.js";import"./index.a5ba7d56.js";const C=g=>(H("data-v-1d9b5106"),g=g(),J(),g),W=C(()=>n("header",null,[n("h2",null,"Profile settings")],-1)),X={key:0},Z={key:1},ee={class:"user-info"},te={class:"user-info"},ae=C(()=>n("p",null,"There was an error update your account informations, please try again.",-1)),oe=["onSubmit"],se=["open"],ne=C(()=>n("p",null,"There was an error deleting your account, please try again.",-1)),le=C(()=>n("p",null,"Are you sure? This action is not reversible, and will delete ALL your data!",-1)),re=$({__name:"user-settings",setup(g){const r=z(),m=l(""),f=l(""),y=l(""),h=l(""),b=l(),E=l(!1),v=l(!1),w=l(!1),A=l(!1),S=l(!1),F=i=>{const e=i.length/10;let p="";for(let s=0;s<i.length;s++)s<e||s>i.length-e?p+=i[s]:p+="*";return p},T=async()=>{A.value=!await P(v,r.editAsync(m.value,f.value,y.value,h.value),!1),A.value||(E.value=!1)},q=async()=>{S.value=!await P(v,r.deleteAsync(),!1),S.value||R("/login")};return U(r.userStore,()=>{var i,e;m.value=((i=r.userStore.userData)==null?void 0:i.username)??"",f.value=((e=r.userStore.userData)==null?void 0:e.email)??""},{immediate:!0}),U(w,()=>{b.value&&(w.value?b.value.showModal():(b.value.close(),S.value=!1))}),(i,e)=>{const p=Y,s=j,L=G,x=Q,k=O;return c(),_(V,null,[n("main",null,[W,t(r).userStore.userData===void 0?(c(),_("p",X,"Loading...")):t(r).userStore.userData===null?(c(),_("p",Z,[a(p,{to:"/login"},{default:u(()=>[d("Log in")]),_:1}),d(" or "),a(p,{to:"/register"},{default:u(()=>[d("Sign up")]),_:1}),d(" to edit your profile! ")])):(c(),_(V,{key:2},[t(E)?(c(),_(V,{key:1},[t(A)?(c(),I(L,{key:0,color:"danger"},{default:u(()=>[ae]),_:1})):N("",!0),n("form",{action:"#",method:"post",onSubmit:M(T,["prevent"])},[a(x,{for:"username",text:"Change username"}),a(k,{modelValue:t(m),"onUpdate:modelValue":e[1]||(e[1]=o=>D(m)?m.value=o:null),type:"text",id:"username",placeholder:"Enter a new username..."},null,8,["modelValue"]),a(x,{for:"email",text:"Change email"}),a(k,{modelValue:t(f),"onUpdate:modelValue":e[2]||(e[2]=o=>D(f)?f.value=o:null),type:"email",id:"email",placeholder:"Enter a new email..."},null,8,["modelValue"]),a(x,{for:"password",text:"Change password"}),a(k,{modelValue:t(y),"onUpdate:modelValue":e[3]||(e[3]=o=>D(y)?y.value=o:null),type:"password",id:"password",placeholder:"Enter a new password..."},null,8,["modelValue"]),a(x,{for:"currentPassword",text:"Current password",required:""}),a(k,{modelValue:t(h),"onUpdate:modelValue":e[4]||(e[4]=o=>D(h)?h.value=o:null),type:"password",id:"currentPassword",placeholder:"Enter your current password...",required:""},null,8,["modelValue"]),a(s,{"full-width":!0,disabled:t(v),class:"save-edits-button",type:"submit"},{default:u(()=>[d("Save")]),_:1},8,["disabled"])],40,oe)],64)):(c(),_(V,{key:0},[n("p",ee,"Username: "+B(t(r).userStore.userData.username),1),n("p",te,"Email: "+B(F(t(r).userStore.userData.email)),1),a(s,{"full-width":!0,onClick:e[0]||(e[0]=o=>E.value=!0)},{default:u(()=>[d("Edit")]),_:1})],64)),a(s,{"full-width":!0,class:"delete-account-button",color:"danger",onClick:e[5]||(e[5]=o=>w.value=!0)},{default:u(()=>[d("Delete account")]),_:1})],64))]),n("dialog",{open:t(w),ref:o=>b.value=o},[t(S)?(c(),I(L,{key:0,color:"danger"},{default:u(()=>[ne]),_:1})):N("",!0),le,n("div",null,[a(s,{disabled:t(v),onClick:e[6]||(e[6]=o=>w.value=!1)},{default:u(()=>[d("No, go back!")]),_:1},8,["disabled"]),a(s,{disabled:t(v),color:"danger",onClick:q},{default:u(()=>[d("Yes, delete my account")]),_:1},8,["disabled"])])],8,se)],64)}}});const pe=K(re,[["__scopeId","data-v-1d9b5106"]]);export{pe as default};
